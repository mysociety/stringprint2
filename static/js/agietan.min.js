var hide_state=true;var current_section="";$(".noscript-anchor").remove()
if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.indexOf(searchString,position)===position;};}
function send_ga(action,value){label=$("body").attr("slug")
value=typeof value!=='undefined'?value:null;if(typeof ga==='function'){ga('send','event','StringPrint',action,label,value)}}
$('#master_expand').on('click touchend',function(event){event.preventDefault();$(".extended-row").toggle();$(".extended").fadeToggle();hide_state=!hide_state;if(hide_state==true){$('#master_expand_link').text("Show All Notes");$(".expand-link").slideDown();}else{$('#master_expand_link').text("Hide All Notes");$(".expand-link").slideUp();};});function changeSelected(id,title,nohash){if(title){$("#mobile-title").text(title);}else{title=$("body").attr("title")
$("#mobile-title").text(title);}
current_section=title;font_size=14
$("#mobile-title").css("font-size",font_size+"pt");while(($("#mobile-navbar-header").height()>($("#mobile-title").height()*3))){font_size=font_size-2
$("#mobile-title").css("font-size",font_size+"pt");}
if(nohash==undefined){nohash=false;}
$("li").removeClass("active");$("#menu-"+id).addClass("active");$("#caret-menu-"+id).addClass("active");if(nohash==false){harmlessHashChange($("#"+id+".anchor").attr('name'));}
adjustMenus(id);}
$("a.nav-link").click(function(){send_ga("Mobile Menu Click",$(this).attr('href'));})
$("a.search_link").click(function(){send_ga("Search");})
$("a.alt_link").click(function(){send_ga("Alt Format - "+$(this).attr('type'));})
$("a.top-nav-item").mouseup(function(){send_ga("Top Nav Click",$(this).attr('href'));id=$(this).attr('section');title=$("#"+id+".section-anchor").text()
changeSelected(id,title,true);})
var visible_ids=[];$.fn.isInViewport=function(){var elementTop=$(this).offset().top;var elementBottom=elementTop+$(this).outerHeight();var viewportTop=$(window).scrollTop();var viewportBottom=viewportTop+$(window).height();return elementBottom>viewportTop&&elementTop<viewportBottom;};$.fn.percentViewport=function(){window_height=$(window).height()
var elementTop=$(this).offset().top;var elementBottom=elementTop+$(this).outerHeight();var viewportTop=$(window).scrollTop()+60;var viewportBottom=viewportTop+window_height;in_scope=elementBottom>viewportTop&&elementTop<viewportBottom;if(in_scope==false){return false;}
if(elementTop>viewportTop){comparison_top=elementTop;}else{comparison_top=viewportTop;}
if(elementBottom>viewportBottom){comparison_bottom=viewportBottom;}else{comparison_bottom=elementBottom;}
gap=comparison_bottom-comparison_top
return gap/window_height;};handle_waypoint=function(ele){if($(ele).is(':visible')==false){return 0;}
id=$(ele).attr('id');int_id=parseInt(id);lower=int_id-5;higher=int_id+5;current_visible=[];for(var i=lower;i<=higher;i++){item=$("#"+i+".content-row")
if(item.is(':visible')&&item.isInViewport()){height=item.percentViewport()
current_visible.push([i,height]);}}
current_visible.sort(function(a,b){a_height=a[1]
b_height=b[1]
return b_height-a_height})
if(current_visible.length==0){return;}
selected=current_visible[0][0]
item=$("#"+selected+".cite-link");link_ref=item.attr("href");para_tag=item.attr("para_tag");$("#mobile-header-link").attr("href",link_ref);$("#mobile-header-link").attr("para_tag",para_tag);}
graph_waypoints_down=$('.content-row').waypoint(function(direction){handle_waypoint(this.element)},{offset:function(){if($(this.element).is(':visible')==true){return 60;}else{return 0}},continuous:false});graph_waypoints_up=$('.content-row').waypoint(function(direction){handle_waypoint(this.element)},{offset:function(){if($(this.element).is(':visible')==true){return 0-$(this.element).height();}else{return 0}},continuous:false});var waypoints=$('.section-anchor').waypoint(function(direction){if($(this.element).is(':visible')==false){return 0;}
if(direction=="down"){id=$(this.element).attr('id');title=$(this.element).text()}else{id=$(this.element).attr('prev');title=$("#"+id+".section-anchor").text()};changeSelected(id,title);},{offset:function(){if($(this.element).is(':visible')==true){return $(this.element).height()+60;}else{return 0}},continuous:false});function scrollToView(element){var offset=element.offset().top+20;if(!element.is(":visible")){element.css({"visibility":"hidden"}).show();var offset=element.offset().top;element.css({"visibility":"","display":""});}
var visible_area_start=$(window).scrollTop();var visible_area_end=visible_area_start+window.innerHeight;if(offset<visible_area_start||offset>visible_area_end){$('html,body').animate({scrollTop:offset-window.innerHeight/3},1000);return false;}
return true;}
$('.expand-footnotes').on('click touchend',function(event){event.preventDefault();id=$(this).attr('id');name=$(this).attr('name');footnotes_window=$("#"+id+".footnotes")
footnotes_window.animate({height:'toggle',opacity:'toggle'},'slow');window.setTimeout(Waypoint.refreshAll,500);if(footnotes_window.is(':visible')){scrollToView($("p#"+name));}
send_ga("Show Footnote",id)});$('.hide-footnotes').on('click touchend',function(event){event.preventDefault();id=$(this).parent().parent().attr('id');$("#"+id+".footnotes").animate({height:'toggle',opacity:'toggle'},'slow');window.setTimeout(Waypoint.refreshAll,500);});$('.expand-link').on('click touchend',function(event){event.preventDefault();$(this).fadeOut();id=$(this).attr('id');$("#"+id+".extended-row").show();$("#"+id+".extended").animate({height:'toggle',opacity:'toggle'},'slow');window.setTimeout(Waypoint.refreshAll,500);send_ga("Show Note",id)});$('.hide-link').on('click touchend',function(event){event.preventDefault();id=$(this).attr('id');$("#"+id+".extended-row").hide();$("#"+id+".extended").animate({height:'toggle',opacity:'toggle'},'slow');$("#"+id+".expand-link").fadeIn();window.setTimeout(Waypoint.refreshAll,500);});$(".content-row").on('mouseenter',function(){id=$(this).attr('id')
$(".cite-link").not(".manual_paragraph").hide();$('#'+id+".cite-link-normal").show();})
$(".content-row").on('click',function(){id=$(this).attr('id')
$(".cite-link").not(".manual_paragraph").hide();$('#'+id+".cite-link-mobile").show();})
var last_id=1
var default_past=1
function adjustMenus(id,future,past){if(future===undefined){future=6;}
if(future<0){future=0}
if(past===undefined){past=default_past;}
if(past<0){past=0}
if(id===undefined){id=last_id}else{id=parseInt(id)
last_id=id}
last_id=id
bottombar=id-past
topbar=id+future
for(var i=bottombar,len=topbar+1;i<len;i++){$("#menu-"+i).removeClass("hide-item");$("#caret-menu-"+i).removeClass("hide-item");}
$(".top-menu-item:visible").each(function(){local=parseInt($(this).attr('item'))
if(local==0){local=1
future=future+1}
if((local<=bottombar)||(local>topbar)){$(this).addClass("hide-item")}})
$(".dropdown:visible").each(function(){local=parseInt($(this).attr('item'))
if(local==0){local=1
future=future+1}
if((local<=bottombar)||(local>topbar)){$(this).addClass("hide-item")}})
if(id>1&&bottombar-1>0){prev_link=$('[section='+bottombar+']').attr('href')
$("a#menu-prev").show().attr("href",prev_link);}else{$("a#menu-prev").hide();}
next_link=$('[section='+(bottombar+2)+']')
if(next_link.length>0){$("a#menu-next").show().attr("href",next_link.attr('href'));}else{$("a#menu-next").hide()}
if(($("#large-menu").height()>($("#brand").height()*3))){if(past>1){adjustMenus(id,future,past-1)}else if(future>0){adjustMenus(id,future-1,past)}}else{}}
function closeCatchup(){$("#catchup").fadeOut()
return false}
function harmlessHashChange(newhash){var isiPad=navigator.userAgent.match(/iPad/i)!=null;if(currently_moving==false&&isiPad==false){$("a[name=temp]").each(function(){old=$(this).attr("temp_name")
$(this).attr('name',old)})
if(newhash!="temp"){if(typeof newhash=="undefined"){window.location.hash="start";}else{existing=$('a[name="'+newhash+'"]')
existing.attr('temp_name',newhash);existing.attr('name',"temp");history.replaceState(undefined,undefined,"#"+newhash)
window.setTimeout(function(){existing.attr('name',newhash)},1);}}}}
function assembleCatchup(section_id,current_sub){start='<div class="row" id="catchup"><div class="col-md-offset-2 col-md-8"><div class="extended" id="catchup"><p><b>Catch Up </b>(<a href="" onclick="return closeCatchup()">close</a>):</p><ul>'
end='</ul></div></div></div>'
body=start
count=0
int_section=parseInt(section_id)
int_current=parseInt(current_sub)
for(i=1;i<=int_section;i++){catch_up=sections[i]['catch_up']
if(catch_up!=""){link=$("#"+i+".linkable")
body+='<li>'+catch_up+' (<a href="#'+link.attr('name')+'">link</a>)</li>'
count+=1}}
current_section=sections[int_section]['sub']
for(var key in current_section){if(parseInt(key)<int_current){link=$("#"+int_section+"g"+key+".linkable")
body+='<li>'+current_section[key]+' (<a href="#'+link.attr('name')+'">link</a>)</li>'
count+=1}}
body+=end
if(count>0){return body}else{return""}};var currently_moving=false
function gotoTarget(target,addText,internalMove){if(internalMove==undefined){internalMove=false;}
if(internalMove==true){highlightTime=5000;createCatchup=false;}else{highlightTime=20000;createCatchup=true;}
para_id=target.attr('name')
if(addText&&currently_moving==false){currently_moving=true
$('#'+para_id+".extended-row").show();$('#'+para_id+".extended").show();$('#'+para_id+".catchup-link").show();$('#'+para_id+".cite-link").html("Entered Here");$('#'+para_id+".cite-link").addClass("manual_paragraph");}
if(internalMove==false){catchup=assembleCatchup(target.attr("parent"),target.attr('last_title'))
$("#"+(parseInt(para_id)+2)+".content-row").before(catchup)
$("#catchup.extended").show()}
$('html,body').scrollTop(target.offset().top-60)
parent=$("#"+target.attr('parent')+".anchor")
$("#"+para_id+".content-row").removeClass('content-row').addClass("highlighted-content content-row")
window.setTimeout(function(){$("#"+para_id+".content-row").removeClass("highlighted-content")},highlightTime)
currently_moving=false;}
function gotoHash(hash,addText){send_ga("External Section Link",hash)
key_areas=hash.split(".")
if(key_areas[0][0]=="#"){key_areas[0]=key_areas[0].substring(1)}
internalMove=false
if(key_areas[0]=="tag"){tag='[tag='+key_areas[1]+']'
options=[tag]
internalMove=true
addText=""}else{key_target='[key='+key_areas[2]+']'
start_end='[start_key='+key_areas[3]+']'+'[end_key='+key_areas[4]+']'
start_para='[start_key='+key_areas[3]+']'+'[position_key='+key_areas[1]+']'
end_para='[end_key='+key_areas[4]+']'+'[position_key='+key_areas[1]+']'
start='[start_key='+key_areas[3]+']'
end='[end_key='+key_areas[4]+']'
para='[position_key='+key_areas[1]+']'+'[parent='+key_areas[0]+']'
section='[section='+key_areas[0]+']'
if(key_areas.length==5){options=[key_target,start_end,start_para,end_para,start,end,para,section]}else if(key_areas.length==6){letter_key='[letter_key='+key_areas[5]+']'
options=[key_target,letter_key,start_end,start_para,end_para,start,end,para,section]}}
for(var i=0,len=options.length;i<len;i++){target=$(options[i]);if(target.length==1){gotoTarget(target,addText,internalMove);break;}}}
$('a').each(function(){var a=new RegExp('/'+window.location.host+'/');if((!a.test(this.href))&&(!$(this).hasClass("nav-link"))){$(this).click(function(event){event.preventDefault();event.stopPropagation();window.open(this.href,'_blank');});}});$(function(){$('a[href*=#]:not([href=#])').on('click touchend',function(){if(dragging==false&&location.pathname.replace(/^\//,'')==this.pathname.replace(/^\//,'')&&location.hostname==this.hostname&&location.pathname==this.pathname&&$(this).hasClass('cite-copy')==false){var splits=this.hash.split(".")
if(splits[0].startsWith("#ref")){target=$('[name='+splits[0].slice(1)+']')
para_id=target.attr('id')
$('html,body').scrollTop($("#"+para_id).offset().top-130)
$("#"+para_id+".content-row").removeClass('content-row').addClass("highlighted-content content-row")
window.setTimeout(function(){$("#"+para_id+".content-row").removeClass("highlighted-content")},2000)
$("#"+para_id+".footnotes").show()
window.setTimeout(Waypoint.refreshAll,500);return false;}else if(splits.length>1){return gotoHash(this.hash.slice(1),false);}else{new_hash=this.hash.slice(1)
if(new_hash=="index"){send_ga("TOC View")
if($("div#index").is(':visible')==false){$("div#index").show()
Waypoint.refreshAll()}}else{if($("div#index").is(':visible')==true){$("div#index").hide()
Waypoint.refreshAll()}}
$('html,body').scrollTop($('a[name="'+new_hash+'"]').offset().top-60)
return false}}else{}});var month=new Array();month[0]="Jan";month[1]="Feb";month[2]="Mar";month[3]="Apr";month[4]="May";month[5]="Jun";month[6]="Jul";month[7]="Aug";month[8]="Sept";month[9]="Oct";month[10]="Nov";month[11]="Dec";function getNow(){var currentDate=new Date()
var day=currentDate.getDate()
var mon=currentDate.getMonth()+1
var year=currentDate.getFullYear()
return day+" "+month[mon-1]+". "+year}
function citeBox(dialog_title,link,para_tag){title=$("body").attr("short_title")
full_title=$("body").attr("full-title")
cite_author=$("body").attr("cite-author")
year=$("body").attr("year")
org=$("body").attr("org")
current_section_name=current_section
if(current_section_name==title){current_section_name="";}
if(current_section_name){current_section_name=": "+current_section_name;current_section_name=current_section_name.trim();}
if(para_tag!=""){ele_name="Paragraph"
ele_id=para_tag}else{ele_name="Paragraph"
ele_id=$(this).attr("id")}
swal({title:dialog_title,text:'Link: <a href="'+link+'">'+title+current_section_name+', '+ele_name+' '+ele_id+'</a>'+
'<br><br>Cite As:<br><span class="cite"> '+cite_author+' ('+year+'), <i>'+full_title+'</i>. [online] , '+org+'. '+ele_name+': '+ele_id+', Available at: '+link+' [Accessed '+getNow()+']</span>',html:true,confirmButtonText:"OK"});send_ga("Generated Link",link)}
$(".cite-copy").on('click touchend',function(e){link=$(this).attr("href")
port=window.location.port;if(port!=""){port=":"+port}
para_tag=$(this).attr("para_tag")
clipboard.copy(link).then(function(){citeBox("Link added to Clipboard!",link,para_tag);},function(err){citeBox("Copy Link From Below!",link,para_tag);})
e.stopPropagation();return false;});$("a.caret-link").on('click touchend',function(){parent_id=$(this).attr("parent")
$("#"+parent_id+".dropdown-toggle").dropdown("toggle");window.location.href=this.href;return false});var dragging=false;$(".nav-link").on("touchmove",function(){dragging=true;});$("body").on("touchstart",function(){dragging=false;});$('.nav-link').on('click touchend',function(){if(dragging){return;}
window.location.href=this.href;$('.navbar-collapse').removeClass('in');return false});function getParameterByName(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return'';return decodeURIComponent(results[2].replace(/\+/g," "));}
$(window).load(function(){hide_state=$("body").attr("hide_state")
if(hide_state=="true"){hide_state=true}else if(hide_state=="false"){hide_state=false}
if(hide_state==true){$(".extended").hide();$(".extended-row").hide();$('#master_expand_link').text("Show All Notes");}else{$('#master_expand_link').text("Hide All Notes");$(".expand-link").hide();};if(window.location.search){hash_loc=getParameterByName("para")
if(hash_loc){new_url=window.location.href.split("?")[0]+"#"+hash_loc
window.history.replaceState({},document.short_title,new_url);}}
if(window.location.hash){var hash=window.location.hash;splits=hash.split(".");if(splits.length>1){return gotoHash(hash,true);}}});function followHash(){var splits=location.hash.split(".")
if(splits.length>1){gotoHash(location.hash);}}
window.onhashchange=followHash;window_resize()});function window_resize(){adjustMenus();Waypoint.refreshAll()}
window.onresize=window_resize;